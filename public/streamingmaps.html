
<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>CS 286</title>

  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href='http://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900' rel='stylesheet' type='text/css'>

  

  <!-- nanoScroller -->
  <link rel="stylesheet" type="text/css" href="assets/nanoScroller/nanoscroller.css" />


  <!-- FontAwesome -->
  <link rel="stylesheet" type="text/css" href="assets/font-awesome/css/font-awesome.min.css" />

  <!-- Material Design Icons -->
  <link rel="stylesheet" type="text/css" href="assets/material-design-icons/css/material-design-icons.min.css" />

  <!-- IonIcons -->
  <link rel="stylesheet" type="text/css" href="assets/ionicons/css/ionicons.min.css" />

  <!-- WeatherIcons -->
  <link rel="stylesheet" type="text/css" href="assets/weatherIcons/css/weather-icons.min.css" />
  <!-- Main -->
  <link rel="stylesheet" type="text/css" href="assets/_con/css/_con.min.css" />
      <link rel="stylesheet" type="text/css" href="assets/jquery-clockpicker/jquery-clockpicker.min.css">

</head>

<body class="yay-hide">
  
  <nav class="navbar-top navbar-dark">
    <div class="nav-wrapper">

      <!-- Sidebar toggle -->
      <a href="#" class="yay-toggle">
        <div class="burg1"></div>
        <div class="burg2"></div>
        <div class="burg3"></div>
      </a>
      <!-- Sidebar toggle -->

      <!-- Logo -->
      <a href="#!" class="brand-logo">
        <h2 class="thin center" style="margin:0px;">CS 286</h2>
      </a>
      <!-- /Logo -->

      <!-- Menu -->
      
      <!-- /Menu -->

    </div>
  </nav>
  <!-- /Top Navbar -->


  
  <aside class="yaybar yay-shrink yay-hide-to-small yay-gestures">

    <div class="top">
      <div>
        <!-- Sidebar toggle -->
        <a href="#" class="yay-toggle">
          <div class="burg1"></div>
          <div class="burg2"></div>
          <div class="burg3"></div>
        </a>
        <!-- Sidebar toggle -->

        <!-- Logo -->
        <a href="#!" class="brand-logo">
          <img src="assets/_con/images/logo-white.png" alt="Con">
        </a>
        <!-- /Logo -->
      </div>
    </div>


    <div class="nano">
      <div class="nano-content">

        

      </div>
    </div>
  </aside>
  <!-- /Yay Sidebar -->


  <!-- Main Content -->
  <section class="content-wrap">


    <!-- Breadcrumb -->
    <div class="page-title">

      <div class="row">
        <div class="col s12 m9 l10">
          <h1>Maps</h1>

          
        </div>
         </div>

    </div>
    <!-- /Breadcrumb -->
    <div class="row">
    <!-- form -->
    
    
    <div class="col s12 l12">
    <div class="card-panel center-align">
    <h4>On going events</h4>
          <div class="map" id="map2" style="height:500px;"></div>
    </div>
    </div>
    
    </div>
  </section>
      
  <!-- /Main Content -->

  <!-- Search Bar -->
  
  <!-- /Search Bar -->



 
  


 
  

  <!-- jQuery -->
  <script type="text/javascript" src="assets/jquery/jquery.min.js"></script>

  <!-- jQuery RAF (improved animation performance) -->
  <script type="text/javascript" src="assets/jqueryRAF/jquery.requestAnimationFrame.min.js"></script>

  <!-- nanoScroller -->
  <script type="text/javascript" src="assets/nanoScroller/jquery.nanoscroller.min.js"></script>

  <!-- Materialize -->
  <script type="text/javascript" src="assets/materialize/js/materialize.min.js"></script>

  <!-- Sortable -->
  <script type="text/javascript" src="assets/sortable/Sortable.min.js"></script>

  <!-- Main -->
  <script type="text/javascript" src="assets/_con/js/_con.min.js"></script>
    <script type="text/javascript" src="assets/jquery-clockpicker/jquery-clockpicker.min.js"></script>
     <!-- Flot -->
  <script type="text/javascript" src="assets/flot/jquery.flot.min.js"></script>
  <script type="text/javascript" src="assets/flot/jquery.flot.time.min.js"></script>
  <script type="text/javascript" src="assets/flot/jquery.flot.pie.min.js"></script>
  <script type="text/javascript" src="assets/flot/jquery.flot.tooltip.min.js"></script>
  <script type="text/javascript" src="assets/flot/jquery.flot.categories.min.js"></script>
    <script type="text/javascript" src="assets/d3/d3.min.js"></script>
    <script type="text/javascript" src="assets/rickshaw/rickshaw.min.js"></script>
      <script src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript" src="assets/gmaps/gmaps.min.js"></script>
    <script type="text/javascript" src="js/base64.js"></script>
    <script type="text/javascript" src="js/makrercluser.js"></script>
    
    
    <script>
	var map;
	 /*
     * MAP 2
     */
    
    
    
    $(document).ready(function(e) {
	  // init map
      map = new GMaps({
          div: '#map2',
          lat: 38.7000,
          lng: 9.1833,
          zoom: 2
      });

		//alert("called");
    	setTimeout(callajax,2000);    
    });
	
	function callajax(){
		
	  var center = new google.maps.LatLng(38.7000, 9.1833);
        var map = new google.maps.Map(document.getElementById('map2'), {
          zoom: 3,
          center: center,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        });
		//alert("wiill do ajax");
		var markers = [];
	 $.ajax({
     type: "GET",
     url: "http://52.34.81.201:3000/getevents",
	 headers: {          
     "Accept" : "application/json; charset=utf-8",         
    "Content-Type": "application/json; charset=utf-8"},
     dataType: 'json',
     data: "",
     async: false,
     crossDomain: true,
     success: function(data) {
        // alert('success'+JSON.stringify(data));
		// console.log(JSON.stringify(data));
		 var rowlen=data.Row.length;
		 console.log(rowlen);
		 if(rowlen>0){
				for(var i=0;i<rowlen;i++){
						var venuelat=Base64.decode(data.Row[i].Cell[1].$);
						var venuelon=Base64.decode(data.Row[i].Cell[2].$);
						var venuename=Base64.decode(data.Row[i].Cell[3].$);
						var latLng = new google.maps.LatLng(venuelat,venuelon);
						var marker = new google.maps.Marker({
            position: latLng,
			infoWindow: {
          content: 'Venue Name: <b>'+venuename+'</b>'
        }
          });
          markers.push(marker);
						//console.log("lat- "+venuelat+" lon-"+venuelon+" name-"+venuename);	
						 /*map.addMarker({
        lat: venuelat,
        lng: venuelon,
        title: venuename,
        infoWindow: {
          content: 'Venue Name: <b>'+venuename+'</b>'
        }
      });*/
							
					}	 
			 }
			 console.log("will post");
			 var markerCluster = new MarkerClusterer(map, markers);
		 
     },
     error: function(response, text, err) {
         alert(err);
     }
 });	
 
		
		}
    
   
    
    </script>
</body>
</html>